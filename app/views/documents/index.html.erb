<div class="container list-page docs">
  <div class="row">
    <h2>Topic's Documents</h2>
  </div>

  <div class="row">
    <div class="action-header">

      <!-- Mobile action buttons -->

      <div class="mobile">
         <div class="actions col-xs-12 text-center">
          <%= link_to "Add Document", new_patient_document_path, class: "btn btn-default" %>
          <br>
          <%= link_to "All Documents", patient_documents_path(@documents), class: "btn btn-default" %>
        </div>
      </div>

      <!-- Search bar -->

      <div class="search col-xs-12 col-md-6">
        <%= form_tag patient_documents_path, method: :get, class: "search-form" do %>
          <%= text_field_tag :query,
            params[:query],
            class: "form-control",
            placeholder: "Find a document by category, title or doctor"
          %>
          <%= button_tag(type: 'submit', class: "btn btn-search") do %>
            <i class="fas fa-search"></i>
          <% end %>
        <% end %>
      </div>

      <!-- Desktop action buttons  -->

      <div class="desktop">
        <div class="actions col-xs-12 col-md-4 col-md-offset-2">
          <%= link_to "Add Document", new_patient_document_path, class: "btn btn-default" %>
          <br>
          <%= link_to "All Documents", patient_documents_path, class: "btn btn-default" %>
        </div>
      </div>
    </div>
  </div>

  <!-- Table container for data -->

  <div class="table-container">

    <!-- Header row -->

    <div class="header-row">
      <div class="row">
        <ul>
          <li class="col col-md-2">Document</li>
          <li class="col col-md-2">Type</li>
          <li class="col col-md-5">Title</li>
          <li class="col col-md-3">Uploaded by</li>
          <li class="col col-md-2">File_type</li>
           <li class="col col-md-2">Status</li>
        </ul>
      </div>
    </div>

    <!-- Each info row -->
    <% @documents.each do |document| %>
      <%# first_update = topic.updates.first %>
      <% last_update = document.topic.updates.last %>

      <div class="show-row">
        <ul class="item-row row">

          <li class="doc-tumb col-xs-12 col-sm-6 col-md-2">
            <% if document.image_data? %>
              <p>
                <%= image_tag(document.image_url, size:"90", alt: "#{document.doc_type.capitalize}")%>
              </p>
            <% end %>
          </li>

          <li class="doc-title col col-xs-6 col-sm-2 col-md-2">
            <p><strong><%= document.doc_type %></strong>
          </li>

          <li class="doc-title col col-xs-6 col-sm-2 col-md-5">
            <p><strong><%= document.doc_title %></strong>
          </li>

          <li class="doc-tumb col col-xs-6 col-sm-2 col-md-3">
            <%= image_tag(document.user.photo, class: "avatar-md") %>
            <div class="update website">
                <p><%= "#{document.user.first_name} #{document.user.last_name}" %></p>
              <span class="small"><%= document.created_at.strftime("%d-%m-%Y") %></span>
            </div>
          </li>

          <li class="doc-tumb col-xs-12 col-sm-6 col-md-2">
            <% if document.image_data? %>
              <div style="width:50px;">
                <%= show_svg("file_icons/jpg.svg") %>
               <span class="small"><%= document.image.metadata["mime_type"] %></span>
               <span class="small"><%= document.image_data.size %>kb</span>
              </div>
            <% end %>
          </li>

          <% case document.status %>
          <% when 'inactive' %>
            <% status_class = 'cured' %>
          <%# when 'under treatment' %>
            <%# status_class = 'under_treatment' %>
          <% else %>
            <% status_class = 'under_treatment' %>
          <% end %>

<!--
          <li class="doc-laststatus col-xs-6 col-sm-2 col-md-2">
            <div class="signal <%= status_class %>">
              <p class="<%= status_class %> website"><%= document.status.capitalize %></p>
            </div>
          </li> -->

          <li class="doc-info col col-xs-12 col-sm-3 col-md-2">

            <%= link_to patient_document_path(@patient, @document), class: "btn btn-default" do %>

             <i class="fas fa-list-ul"></i><span> <%= document.id %></span><span class="website"> Show</span>
            <% end %>

            <%= link_to patient_documents_path(), class: "btn btn-default" do %>
              <i class="far fa-file-alt"></i><span> <%#= @documents.where(status: 'active').count - document.topic.where(status: 'active', doc_type: 'Exam').count %></span><span class="website"> Edit</span>
            <% end %>

            <%= link_to patient_documents_path(), class: "btn btn-default" do %>
              <i class="far fa-chart-bar"></i><span> <%#= @documents.where(status: 'active', doc_type: 'Exam').count %></span><span class="website"> Download</span>
            <% end %>

            <%= link_to patient_documents_path(), class: "btn btn-default" do %>
              <i class="far fa-calendar-alt"></i><span> <%#= @document.topic.schedules.where(status: 'active').count %></span><span class="website"> Deactivate</span>
            <% end %>
          </li>

        </ul>


      </div>
    <% end %>

    </div>
  </div>
<!-- </div> -->

<%= link_to 'Edit', edit_document_path(document) %>
<%= link_to 'New Document', new_patient_document_path %>

<%#= link_to 'New Document', new_patient_document_path %>

